
<!-- toc orderedList:0 -->

- [第一章 概述](#第一章-概述)
	- [1.1 前言](#11-前言)
	- [1.2 系统组成](#12-系统组成)
	- [1.3 操作系统和应用程序](#13-操作系统和应用程序)
	- [1.4 启动和登陆](#14-启动和登陆)
	- [1.5 文件](#15-文件)
	- [补充：路径](#补充路径)
	- [1.6 程序、进程](#16-程序-进程)
	- [1.7 错误处理](#17-错误处理)
	- [1.8 用户、组、文件权限](#18-用户-组-文件权限)
	- [1.9 信号](#19-信号)
	- [1.10 系统调用和库函数](#110-系统调用和库函数)

<!-- tocstop -->

# 第一章 概述
## 1.1 前言
本章讨论系统的概念，从硬件、操作系统角度更加深刻的理解计算机系统，并快速浏览Linux系统提供的服务。


## 1.2 系统组成
```{mermaid}
graph TB
系统-->软件
系统-->硬件
软件-->操作系统
软件-->应用程序
硬件-->CPU
硬件-->内存
硬件-->硬盘
硬件-->键盘
硬件-->鼠标
硬件-->显卡
操作系统-->内核
操作系统-->系统软件
```

## 1.3 操作系统和应用程序
> 操作系统这个词语有二意性，有时候指内核，有时候指内核和系统工具软件的组合。
```{mermaid}
graph TB
操作系统-->linux
操作系统-->windows
操作系统-->osx
操作系统-->unix
```

操作系统是管理系统硬件的软件。操作系统是直接运行在裸机之上。其他应用软件运行在操作系统之上。

操作系统本身提供操作接口，支持用户通过该接口来操作 系统，但是系统本身提供的功能，不足于完成用户需求时，则需要开发应用程序来拓展系统功能。

发行版：
不同的公司使用Linux内核，加上自己开发的系统工具软件，一起发布的Linux操作系统版本。

## 1.4 启动和登陆
```{mermaid}
graph LR
上电-->主板bios
主板bios-->boot
boot-->kernel
kernel --> init
init --> login
login --> shell
```

配置文件：
/etc/profile：系统启动时被执行
~/.bashrc：用户登陆时会调用

- 主板bios：初始化主板，初始化硬盘
- boot：bootloader，可以用来选择启动的操作系统
- kernel：初始化硬件
- init进程：Linux系统的第一个程序，会执行/etc/profile脚本
- login进程：提供用户接口，供用户登陆，会执行/etc/.bashrc脚本
- shell进程：提供用户接口，供用户输入命令，shell会解析命令，操作计算机

## 1.5 文件
文件是一个重要的概念，一般定义为信息的集合。计算机做为信息处理的机器，文件是计算机处理的对象。

在Unix和Linux系统中，泛化了文件的概念，设备也被抽象成文件对象来进行操作。

数据的集合叫做文件。
IT行业处理信息：转换，传输，存储


## 补充：路径
/: 根目录
/aaa/bbb/ccc：以\/分割文件名
HOME目录：使用~表示，其实是你的用户目录，一般来说，一个用户只能操作他自己的HOME目录，其他目录是不能写的。使用cd命令，默认切换到HOME目录。
当前目录：
相对路径和绝对路径：
相对路径和绝对路径转换：realpath


## 1.6 程序、进程
```{mermaid}
graph TB
subgraph 硬盘
程序1
程序2
end
subgraph 内存
进程1
进程2
进程3
进程4
end
程序1-->进程1
程序1-->进程2
程序1-->进程3
程序2-->进程4
```
## 1.7 错误处理
系统调用在**一般情况下**返回整数，并且0表示成功，小于0表示失败。当系统调用返回失败时，可以通过errno获得错误码，通过strerror获取错误解释，或者直接通过perror在标准错误文件中，输出错误信息。
```
int main()
{
    int fd = open("a.txt", O_RDWR);
    if(fd < 0)
    {
        printf("errno is %d, error string=%s\n", errno, strerror(errno));
        perror("open");
    }
}
```
## 1.8 用户、组、文件权限
Linux是多用户系统，支持多个用户同时登陆系统。
为了安全起见，需要对系统的权限加于规范。

## 1.9 信号
信号是进程通信的一种手段，某个进程收到信号，该信号可能来自内核、来自其它进程或者来自用户操作。例如：当用户按下ctrl+c时，其实是给前台进程发送了一个信号。

## 1.10 系统调用和库函数
学习Linux系统开发接口时，程序员也需要学习一般常用的第三方库，来拓展程序员的编程能力。
```{mermaid}
graph LR
USER(用户)
subgraph Computer Memory
subgraph User space
APP(应用程序)
D(C和C++以及第三方库函数)
A(系统调用接口)
B(SHELL)
end
subgraph Kernel space
C(系统内核)
end
end
A-->C
B-->A
D-->A
APP-->A
APP-->D
USER-->APP
USER-->B
学习重点1-.->A
学习重点2-.->B
学习重点3-.->D
```

User Space和Kernel Space是操作系统编程中常用的概念，表示当前的代码在用户空间还是内核空间运行，对于不同的运行空间，CPU对内存的处理方式稍有不同，在讲进程虚拟地址空间时再涉及该概念。

系统调用指操作系统内核提供的功能，它提供了接口给用户空间代码调用。比如open/read/write/close等，都是属于Linux系统操作接口，而fopen/fread/fwrite/fclose是属于C标准提供的接口，在Linux下，fopen其实底层调用了open。
